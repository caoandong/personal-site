@import 'tailwindcss';
@import 'katex/dist/katex.min.css';

@plugin '@tailwindcss/typography';

:root {
  --background: #ffffff;
  --foreground: #0a0a0a;
  --heading: #171717; /* neutral-900 */
  --body: #404040; /* neutral-700 */
  --muted: #f4f4f5;
  --muted-foreground: #71717a;
  --grey-1: #52525b;
  --grey-2: #a1a1aa;
  --border: #e4e4e7;
  --stroke: #e4e4e7;
  --primary: #18181b;
  --primary-foreground: #fafafa;
}

.dark {
  --background: #0a0a0a;
  --foreground: #fafafa;
  --heading: #f5f5f5; /* neutral-100 */
  --body: #d4d4d4; /* neutral-300 */
  --muted: #27272a;
  --muted-foreground: #a1a1aa;
  --grey-1: #a1a1aa;
  --grey-2: #71717a;
  --border: #27272a;
  --stroke: #27272a;
  --primary: #fafafa;
  --primary-foreground: #18181b;
}

/*
 * SINGLE SOURCE OF TRUTH: All design tokens defined here via @theme
 * Tailwind generates utilities (text-h1, text-body, etc.) from these tokens
 *
 * Note: @theme requires explicit values, not var() references to other theme
 * variables, because it's processed at build time.
 */
@theme inline {
  /* Colors */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-heading: var(--heading);
  --color-body: var(--body);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-grey-1: var(--grey-1);
  --color-grey-2: var(--grey-2);
  --color-border: var(--border);
  --color-stroke: var(--stroke);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);

  /*
   * Typography Scale - SINGLE SOURCE OF TRUTH
   * Mobile-first with responsive overrides via Tailwind breakpoints
   *
   * Usage: text-h1, text-h2, text-h3, text-body, text-small, text-nav
   * These generate Tailwind utilities automatically
   */

  /* Heading 1: text-3xl on mobile → text-5xl (md/lg) */
  --font-size-h1: 1.875rem; /* 30px - text-3xl */
  --font-size-h1-md: 3rem; /* 48px - text-5xl */
  --font-size-h1-lg: 3rem; /* 48px - text-5xl */
  --line-height-h1: 1.2;

  /* Heading 2: text-xl on mobile → text-2xl (md) */
  --font-size-h2: 1.25rem; /* 20px - text-xl */
  --font-size-h2-md: 1.5rem; /* 24px - text-2xl */
  --line-height-h2: 1.3;

  /* Heading 3: text-xl */
  --font-size-h3: 1.25rem; /* 20px - text-xl */
  --font-size-h3-md: 1.25rem; /* 20px - text-xl */
  --line-height-h3: 1.4;

  /* Body text */
  --font-size-body: 1.25rem; /* 20px - text-xl */
  --line-height-body: 1.625; /* leading-relaxed */

  /* Code text (slightly smaller than body for visual consistency with monospace) */
  --font-size-code: 0.975rem; /* ~15.6px */

  /* Small/caption text */
  --font-size-small: 1.125rem; /* 18px - text-lg */
  --line-height-small: 1.5;

  /* Navigation text */
  --font-size-nav: 1.125rem; /* 18px - text-lg */
  --line-height-nav: 1.5;

  /* Spacing tokens for typography */
  --spacing-h1-mt: 3rem; /* mt-12 */
  --spacing-h1-mb: 2rem; /* mb-8 */
  --spacing-h2-mt: 5rem; /* mt-20 */
  --spacing-h2-mb: 1.5rem; /* mb-6 */
  --spacing-h3-mt: 3.5rem; /* mt-14 */
  --spacing-h3-mb: 1rem; /* mb-4 */
  --spacing-p-my: 1.5rem; /* my-6 */
  --spacing-list-my: 2rem; /* my-8 */
  --spacing-li-mt: 0.75rem; /* mt-3 */
  --spacing-blockquote-my: 2rem; /* my-8 */
}

body {
  background: var(--background);
  color: var(--body);
  font-weight: 300;
}

/* Smooth transitions for interactive elements */
a {
  transition: color 200ms ease;
}

a:hover {
  color: var(--grey-1);
}

/* Prose styling for MDX content */
.prose {
  --tw-prose-body: var(--body);
  --tw-prose-headings: var(--heading);
  --tw-prose-links: var(--body);
  --tw-prose-bold: var(--heading);
  --tw-prose-code: var(--body);
  --tw-prose-quotes: var(--body);
  --tw-prose-counters: var(--grey-1);
  --tw-prose-bullets: var(--grey-1);
  --tw-prose-hr: var(--stroke);
  --tw-prose-quote-borders: var(--stroke);
}

/*
 * Prose heading styles - using @theme tokens as single source of truth
 * Font sizes, line heights, and spacing all reference the tokens above
 */
.prose h1,
.prose h2,
.prose h3 {
  font-weight: 300;
  letter-spacing: -0.02em;
}

.prose h1 {
  font-size: var(--font-size-h1);
  line-height: var(--line-height-h1);
  margin-top: var(--spacing-h1-mt);
  margin-bottom: var(--spacing-h1-mb);
}

.prose h2 {
  font-size: var(--font-size-h2);
  line-height: var(--line-height-h2);
  margin-top: var(--spacing-h2-mt);
  margin-bottom: var(--spacing-h2-mb);
}

.prose h3 {
  font-size: var(--font-size-h3);
  line-height: var(--line-height-h3);
  margin-top: var(--spacing-h3-mt);
  margin-bottom: var(--spacing-h3-mb);
}

.prose p {
  margin-top: var(--spacing-p-my);
  margin-bottom: var(--spacing-p-my);
  line-height: var(--line-height-body);
}

.prose ul,
.prose ol {
  margin-top: var(--spacing-list-my);
  margin-bottom: var(--spacing-list-my);
}

.prose li {
  margin-top: var(--spacing-li-mt);
}

.prose blockquote {
  margin-top: var(--spacing-blockquote-my);
  margin-bottom: var(--spacing-blockquote-my);
}

/* First child headings have no top margin */
.prose > h1:first-child,
.prose > h2:first-child,
.prose > h3:first-child {
  margin-top: 0;
}

/* Responsive font sizes using @theme tokens */
@media (min-width: 768px) {
  .prose h1 {
    font-size: var(--font-size-h1-md);
  }
  .prose h2 {
    font-size: var(--font-size-h2-md);
  }
  .prose h3 {
    font-size: var(--font-size-h3-md);
  }
}

@media (min-width: 1024px) {
  .prose h1 {
    font-size: var(--font-size-h1-lg);
  }
}

/* Ensure prose links don't inherit global hover */
.prose a:hover {
  color: var(--grey-1);
}

/* Inline code styling */
.prose code:not(pre code) {
  background-color: var(--muted);
  padding: 0.2rem 0.4rem;
  border-radius: 0.25rem;
  font-size: var(--font-size-code);
  font-weight: 500;
}

/* Code block styling for rehype-pretty-code */
pre {
  border-radius: 0.75rem;
  padding: 1.25rem 1.5rem;
  margin-top: 2.5rem;
  margin-bottom: 2.5rem;
  overflow-x: auto;
  font-size: var(--font-size-code);
  line-height: 1.7;
  background-color: var(--muted);
}

pre > code {
  display: grid;
}

/* Shiki dual theme - transparent spans so pre's rounded corners show */
pre [data-theme*=' '],
pre [data-theme*=' '] span {
  color: var(--shiki-light);
  background-color: transparent;
}

.dark pre [data-theme*=' '],
.dark pre [data-theme*=' '] span {
  color: var(--shiki-dark);
  background-color: transparent;
}

/* KaTeX styling adjustments */
.katex-display {
  overflow-x: auto;
  overflow-y: hidden;
  padding: 1rem 0;
}
